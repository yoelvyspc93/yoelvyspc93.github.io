---
import Button from '@/ui/Button.astro'
import ProjectsCard from '@/shared/ProjectsCard.astro'
import { getCollection } from 'astro:content'

type ProjectsSectionCopy = {
	latest: string
	latestHighlight: string
	seeMore: string
}

const PROJECTS_SECTION: ProjectsSectionCopy = {
	latest: 'Latest',
	latestHighlight: 'Projects',
	seeMore: 'See more',
}

// Carga de content collection
const allProjects = await getCollection('projects')
const latestProjects = allProjects
	.map((p) => p.data)
	.filter((p) => p.isFavorite)

// UI-only: sin refs, sin animaciones, sin hover overlay compartido.
---

<section
	id="projects"
	class="flex flex-col items-center max-w-full h-auto max-h-full gap-6 py-16 md:gap-8 md:py-20 lg:gap-12 lg:pt-36 lg:pb-24 xl:gap-15"
>
	<h2
		class="font-display text-heading-2 font-normal text-white uppercase text-center px-4"
	>
		{latestProjects.length}
		{PROJECTS_SECTION.latest}{' '}
		<span class="text-pink-purple">{PROJECTS_SECTION.latestHighlight}</span>
	</h2>

	<div class="relative w-full flex flex-col isolate">
		{
			latestProjects.map((project) => (
				<a
					href={`/projects#project-${project.id}`}
					class="relative z-[1] no-underline bg-transparent border-0"
					aria-label={`${project.title} project`}
				>
					<article class="w-full px-4">
						<ProjectsCard
							number={project.id}
							title={project.title}
							content={project.shortDescription}
						/>
					</article>
				</a>
			))
		}
	</div>

	<div class="pt-2">
		<Button href="/projects" aria-label="See more projects">
			{PROJECTS_SECTION.seeMore}
		</Button>
	</div>
</section>
